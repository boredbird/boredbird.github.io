---
title: 插值
date: 2017-11-13 22:06:12 
categories: "机器学习" 
tags: 
     - 插值
     - 重心插值
     - 三次样条插值
     - Hermite插值
     - 临近点插值
     - 线性插值
     - Newton插值
     - Lagrange插值
description: 插值
toc: true
---
# 插值的定义
插值法又称“内插法”，是利用函数f(x)在某区间中已知的若干点的函数值，作出适当的特定函数，在区间的其他点上用这特定函数的值作为函数f(x)的近似值，这种方法称为插值法。如果这特定函数是多项式，就称它为插值多项式。

<div class="fig figcenter fighighlight">
  <img src="/assets/ML/interpolation/QQ截图20171113112144.png" width="50%">
  <div class="figcaption">
  </div>
</div>

<!--more-->

插入法的拉丁文原意是“内部插入”，即在已知的函数表中，插入一些表中没有列出的、所需要的中间值。

若函数f(x)在自变数x一些离散值所对应的函数值为已知，则可以作一个适当的特定函数p(x)，使得p(x)在这些离散值所取的函数值，就是f(x)的已知值。从而可以用p(x)来估计f(x)在这些离散值之间的自变数所对应的函数值，这种方法称为插值法。

[scipy的插值模块](https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html#using-radial-basis-functions-for-smoothing-interpolation)


## Lagrange插值
Lagrange插值是n次多项式插值，其成功地用构造插值基函数的 方法解决了求n次多项式插值函数问题。

★基本思想　将待求的n次多项式插值函数pn(x）改写成另一种表示方式，再利用插值条件⑴确定其中的待定函数，从而求出插值多项式。

## Newton插值
Newton插值也是n次多项式插值，它提出另一种构造插值多项式的方法，与Lagrange插值相比，具有承袭性和易于变动节点的特点。

★基本思想　将待求的n次插值多项式Pn（x）改写为具有承袭性的形式，然后利用插值条件⑴确定Pn（x）的待定系数，以求出所要的插值函数。

## Hermite插值
Hermite插值是利用未知函数f(x)在插值节点上的函数值及导数值来构造插值多项式的，其提法为：给定n+1个互异的节点x0,x1，……,xn上的函数值和导数值求一个2n+1次多项式H2n+1(x)满足插值条件

H2n+1(xk)=yk

H'2n+1(xk)=y'k k=0,1,2，……，n ⒀

如上求出的H2n+1(x）称为2n+1次Hermite插值函数，它与被插函数一般有更好的密合度.

★基本思想

利用Lagrange插值函数的构造方法，先设定函数形式，再利用插值条件⒀求出插值函数.

# 插值举例

``` python

	#!/usr/bin/python
	# -*- coding:utf-8 -*-
	import numpy as np
	import scipy
	import matplotlib.pyplot as plt
	from scipy.stats import norm, poisson
	from scipy.interpolate import BarycentricInterpolator
	from scipy.interpolate import CubicSpline

    x = np.random.poisson(lam=5, size=10000)
    print x
    pillar = 15
    a = plt.hist(x, bins=pillar, normed=True, range=[0, pillar], color='g', alpha=0.5)
    plt.grid()
    # plt.show()
    print a
    print a[0].sum()

    rv = poisson(5)
    x1 = a[1]
    y1 = rv.pmf(x1)
    itp = BarycentricInterpolator(x1, y1)  # 重心插值
    x2 = np.linspace(x.min(), x.max(), 50)
    y2 = itp(x2)
    cs = scipy.interpolate.CubicSpline(x1, y1)       # 三次样条插值
    plt.plot(x2, cs(x2), 'm--', linewidth=5, label='CubicSpine')           # 三次样条插值
    plt.plot(x2, y2, 'g-', linewidth=3, label='BarycentricInterpolator')   # 重心插值
    plt.plot(x1, y1, 'r-', linewidth=1, label='Actural Value')             # 原始值
    plt.legend(loc='upper right')
    plt.grid()
    plt.show()

```

<div class="fig figcenter fighighlight">
  <img src="/assets/ML/interpolation/QQ截图20171113112640.png" width="80%">
  <div class="figcaption">
  </div>
</div>

# 拟合与插值的区别

插值曲线要过数据点，拟合曲线整体效果更好。

插值是指已知某函数的在若干离散点上的函数值或者导数信息，通过求解该函数中待定形式的插值函数以及待定系数，使得该函数在给定离散点上满足约束。

拟合是指已知某函数的若干离散函数值，通过调整该函数中若干待定系数，使得该函数与已知点集的差别（最小二乘意义）最小。如果待定函数是线性，就叫线性拟合或线性回归，否则叫非线性拟合或非线性回归。表达式也可以是分段函数，这种情况下叫样条拟合。

从几何意义上讲，拟合是给定了空间中的一些点，找到一个已知形式未知参数的连续曲面来最大限度地逼近这些点；而插值是找到一个（或几个分片光滑的）连续曲面来穿过这些点。

随着插值节点的增多，多项式次数也在增高，插值曲线在一些区域出现跳跃，并且越来越偏离原始曲线。

<div class="fig figcenter fighighlight">
  <img src="/assets/ML/interpolation/QQ截图20171113114204.png" width="80%">
  <div class="figcaption">
  </div>
</div>

为了解决这个问题，人们发明了分段插值法。分段插值一般不会使用四次以上的多项式，而二次多项式会出现尖点，也是有问题的。所以就剩下线性和三次插值，最后使用最多的还是线性分段插值，这个好处是显而易见的。

via

* [百度百科-插值法](https://baike.baidu.com/item/%E6%8F%92%E5%80%BC%E6%B3%95/967119?fr=aladdin)

* [scipy.interpolate](https://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html#using-radial-basis-functions-for-smoothing-interpolation)

* [知乎-拟合与插值的区别](https://www.zhihu.com/question/24276013)