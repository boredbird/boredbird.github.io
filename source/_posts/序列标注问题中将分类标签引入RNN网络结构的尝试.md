---
title: 序列标注问题中将分类标签引入RNN网络结构的尝试
date: 2018-07-16 16:28:12
categories: "深度学习"
tags:
     - RNN
     - LSTM
     - 序列标注
description: 序列标注问题中将分类标签引入RNN网络结构的尝试
toc: true
---

https://blog.csdn.net/malefactor/article/details/52444022#0-tsina-1-63702-397232819ff9a47a7b7e80a40613cfe1
## RNN解决序列标注问题
![RNN解决序列标注问题](assets/20160905213752377.jpg)

目前使用RNN做序列标注问题，总体而言，跟传统方法比效果相当，并没有表现出特殊明显的优势，我觉得可能跟大多数序列标注问题所需要参考的上下文比较短，所以神经网络模型并不太能发挥出其优势有关。

RNN典型网络结构做序列标注任务的问题是什么呢？很明显RNN结构做序列标注问题，不论你套上多少层RNN或者LSTM，其在预测某个单词的标签时，只是考虑了单词本身以及其所在上下文里包含单词的信息。难道这还不够吗？其实还不够。有一类可以利用的信息在这个结构里没有考虑进来，就是单词的分类标签之间的相互影响。

## biLSTM+CRF解决标注偏置问题
![biLSTM+CRF](assets/20160905213826892.jpg)

如何将标签之间的相互影响这个因素体现到神经网络结构下的序列标注问题里呢？这个问题其实是值得探索的一个方向。之前有类方法这么做：RNN在每个时间步t对每个单词输出若干候选标签(这么讲只是为了方便理解，真实在做的时候并没有输出候选标签，而是把隐层节点的状态作为CRF的输入)，对于一句话来说，每个单词输出若干候选标签，但是这时候还没定下来到底哪个是最终要输出的标签，在这些候选标签之上再套上一层CRF模型来寻找全局最优的标签组合路径（上图）。

RNN考虑的是根据单词和单词所处上下文给出候选标签，CRF融合全局标签信息得出最优解。


<!--more-->

## 标签作为输入特征的RNN模型
![标签作为输入特征的RNN模型](assets/20160905213901877.jpg)

和图1的标准RNN解决序列标注问题的网络结构相比，RNN的每个时间步t的输入由原先的单独的t时刻输入Xt，现在改造成每一时刻输入有两个：一个是t时刻的输入Xt，另外一个是t-1时刻输出的标签Y(t-1)。这样，就将前一时刻的标签输出作为当前时刻的输入，也就是将标签作为特征引入到神经网络模型中来。引入这个改进后，貌似好像只是把前一时刻的标签对当前时刻的标签影响建立到模型里，但是其实不仅仅如此，在t时刻的RNN网络隐层对前面时刻1到时刻t-1的标签都建立到模型里去了，只不过是体现在隐层状态上，也就是说这个结构应该可以对标签之间的远程影响也能建立到看上去很简单的模型中去。

在序列标注问题中，从道理上讲也是有一定合理性的。如何训练整个模型呢？在训练阶段，因为训练数据的每个输入单词都是带标准答案标签的，所以在训练时刻，t时刻的输入标签可以直接用t-1时刻的输出标签。这样就能够训练神经网络模型，而训练出的神经网络模型是融合了单词上下文信息以及标签序列之间的相互影响因素的。在推理阶段，t时刻的输入标签则直接用t-1时刻预测输出的标签。
